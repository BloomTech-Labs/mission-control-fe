{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _promise = require('babel-runtime/core-js/promise');\n\nvar _promise2 = _interopRequireDefault(_promise);\n\nvar _stringify = require('babel-runtime/core-js/json/stringify');\n\nvar _stringify2 = _interopRequireDefault(_stringify);\n\nvar _regenerator = require('babel-runtime/regenerator');\n\nvar _regenerator2 = _interopRequireDefault(_regenerator);\n\nvar _getIterator2 = require('babel-runtime/core-js/get-iterator');\n\nvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\nvar _asyncToGenerator2 = require('babel-runtime/helpers/asyncToGenerator');\n\nvar _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _configurationValidation = require('@okta/configuration-validation');\n\nvar _oktaAuthJs = require('@okta/okta-auth-js');\n\nvar _oktaAuthJs2 = _interopRequireDefault(_oktaAuthJs);\n\nvar _packageInfo = require('./packageInfo');\n\nvar _packageInfo2 = _interopRequireDefault(_packageInfo);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar containsAuthTokens = /id_token|access_token|code/;\n/*\n * Copyright (c) 2017-Present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nvar Auth = function () {\n  function Auth(config) {\n    (0, _classCallCheck3.default)(this, Auth);\n    var testing = {\n      // If the config is undefined, cast it to false\n      disableHttpsCheck: !!config.disableHttpsCheck\n    }; // normalize authJS config. In this SDK, we allow underscore on certain properties, but AuthJS consistently uses camel case.\n\n    var authConfig = (0, _configurationValidation.buildConfigObject)(config);\n    (0, _configurationValidation.assertIssuer)(authConfig.issuer, testing);\n    (0, _configurationValidation.assertClientId)(authConfig.clientId);\n    (0, _configurationValidation.assertRedirectUri)(authConfig.redirectUri);\n    this._oktaAuth = new _oktaAuthJs2.default(authConfig);\n    this._oktaAuth.userAgent = _packageInfo2.default.name + '/' + _packageInfo2.default.version + ' ' + this._oktaAuth.userAgent;\n    this._config = authConfig; // use normalized config\n\n    this._history = config.history;\n    this.handleAuthentication = this.handleAuthentication.bind(this);\n    this.isAuthenticated = this.isAuthenticated.bind(this);\n    this.getUser = this.getUser.bind(this);\n    this.getIdToken = this.getIdToken.bind(this);\n    this.getAccessToken = this.getAccessToken.bind(this);\n    this.login = this.login.bind(this);\n    this.logout = this.logout.bind(this);\n    this.redirect = this.redirect.bind(this);\n  }\n\n  (0, _createClass3.default)(Auth, [{\n    key: 'handleAuthentication',\n    value: function () {\n      var _ref = (0, _asyncToGenerator3.default)(\n      /*#__PURE__*/\n      _regenerator2.default.mark(function _callee() {\n        var tokens, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, token;\n\n        return _regenerator2.default.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this._oktaAuth.token.parseFromUrl();\n\n              case 2:\n                tokens = _context.sent;\n                tokens = Array.isArray(tokens) ? tokens : [tokens];\n                _iteratorNormalCompletion = true;\n                _didIteratorError = false;\n                _iteratorError = undefined;\n                _context.prev = 7;\n\n                for (_iterator = (0, _getIterator3.default)(tokens); !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                  token = _step.value;\n\n                  if (token.idToken) {\n                    this._oktaAuth.tokenManager.add('idToken', token);\n                  } else if (token.accessToken) {\n                    this._oktaAuth.tokenManager.add('accessToken', token);\n                  }\n                }\n\n                _context.next = 15;\n                break;\n\n              case 11:\n                _context.prev = 11;\n                _context.t0 = _context['catch'](7);\n                _didIteratorError = true;\n                _iteratorError = _context.t0;\n\n              case 15:\n                _context.prev = 15;\n                _context.prev = 16;\n\n                if (!_iteratorNormalCompletion && _iterator.return) {\n                  _iterator.return();\n                }\n\n              case 18:\n                _context.prev = 18;\n\n                if (!_didIteratorError) {\n                  _context.next = 21;\n                  break;\n                }\n\n                throw _iteratorError;\n\n              case 21:\n                return _context.finish(18);\n\n              case 22:\n                return _context.finish(15);\n\n              case 23:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[7, 11, 15, 23], [16,, 18, 22]]);\n      }));\n\n      function handleAuthentication() {\n        return _ref.apply(this, arguments);\n      }\n\n      return handleAuthentication;\n    }()\n  }, {\n    key: 'isAuthenticated',\n    value: function () {\n      var _ref2 = (0, _asyncToGenerator3.default)(\n      /*#__PURE__*/\n      _regenerator2.default.mark(function _callee2() {\n        return _regenerator2.default.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (!(location && location.hash && containsAuthTokens.test(location.hash))) {\n                  _context2.next = 2;\n                  break;\n                }\n\n                return _context2.abrupt('return', null);\n\n              case 2:\n                _context2.next = 4;\n                return this.getAccessToken();\n\n              case 4:\n                _context2.t0 = !!_context2.sent;\n\n                if (_context2.t0) {\n                  _context2.next = 9;\n                  break;\n                }\n\n                _context2.next = 8;\n                return this.getIdToken();\n\n              case 8:\n                _context2.t0 = !!_context2.sent;\n\n              case 9:\n                return _context2.abrupt('return', _context2.t0);\n\n              case 10:\n              case 'end':\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function isAuthenticated() {\n        return _ref2.apply(this, arguments);\n      }\n\n      return isAuthenticated;\n    }()\n  }, {\n    key: 'getUser',\n    value: function () {\n      var _ref3 = (0, _asyncToGenerator3.default)(\n      /*#__PURE__*/\n      _regenerator2.default.mark(function _callee3() {\n        var accessToken, idToken, userinfo;\n        return _regenerator2.default.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return this._oktaAuth.tokenManager.get('accessToken');\n\n              case 2:\n                accessToken = _context3.sent;\n                _context3.next = 5;\n                return this._oktaAuth.tokenManager.get('idToken');\n\n              case 5:\n                idToken = _context3.sent;\n\n                if (!(accessToken && idToken)) {\n                  _context3.next = 12;\n                  break;\n                }\n\n                _context3.next = 9;\n                return this._oktaAuth.token.getUserInfo(accessToken);\n\n              case 9:\n                userinfo = _context3.sent;\n\n                if (!(userinfo.sub === idToken.claims.sub)) {\n                  _context3.next = 12;\n                  break;\n                }\n\n                return _context3.abrupt('return', userinfo);\n\n              case 12:\n                return _context3.abrupt('return', idToken ? idToken.claims : undefined);\n\n              case 13:\n              case 'end':\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function getUser() {\n        return _ref3.apply(this, arguments);\n      }\n\n      return getUser;\n    }()\n  }, {\n    key: 'getIdToken',\n    value: function () {\n      var _ref4 = (0, _asyncToGenerator3.default)(\n      /*#__PURE__*/\n      _regenerator2.default.mark(function _callee4() {\n        var idToken;\n        return _regenerator2.default.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.prev = 0;\n                _context4.next = 3;\n                return this._oktaAuth.tokenManager.get('idToken');\n\n              case 3:\n                idToken = _context4.sent;\n                return _context4.abrupt('return', idToken.idToken);\n\n              case 7:\n                _context4.prev = 7;\n                _context4.t0 = _context4['catch'](0);\n                return _context4.abrupt('return', undefined);\n\n              case 10:\n              case 'end':\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this, [[0, 7]]);\n      }));\n\n      function getIdToken() {\n        return _ref4.apply(this, arguments);\n      }\n\n      return getIdToken;\n    }()\n  }, {\n    key: 'getAccessToken',\n    value: function () {\n      var _ref5 = (0, _asyncToGenerator3.default)(\n      /*#__PURE__*/\n      _regenerator2.default.mark(function _callee5() {\n        var accessToken;\n        return _regenerator2.default.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                _context5.prev = 0;\n                _context5.next = 3;\n                return this._oktaAuth.tokenManager.get('accessToken');\n\n              case 3:\n                accessToken = _context5.sent;\n                return _context5.abrupt('return', accessToken.accessToken);\n\n              case 7:\n                _context5.prev = 7;\n                _context5.t0 = _context5['catch'](0);\n                return _context5.abrupt('return', undefined);\n\n              case 10:\n              case 'end':\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this, [[0, 7]]);\n      }));\n\n      function getAccessToken() {\n        return _ref5.apply(this, arguments);\n      }\n\n      return getAccessToken;\n    }()\n  }, {\n    key: 'login',\n    value: function () {\n      var _ref6 = (0, _asyncToGenerator3.default)(\n      /*#__PURE__*/\n      _regenerator2.default.mark(function _callee6(fromUri, additionalParams) {\n        var referrerPath, auth, history;\n        return _regenerator2.default.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                referrerPath = fromUri ? {\n                  pathname: fromUri\n                } : this._history.location;\n                localStorage.setItem('secureRouterReferrerPath', (0, _stringify2.default)(referrerPath));\n\n                if (!this._config.onAuthRequired) {\n                  _context6.next = 6;\n                  break;\n                }\n\n                auth = this;\n                history = this._history;\n                return _context6.abrupt('return', this._config.onAuthRequired({\n                  auth: auth,\n                  history: history\n                }));\n\n              case 6:\n                _context6.next = 8;\n                return this.redirect(additionalParams);\n\n              case 8:\n              case 'end':\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function login(_x, _x2) {\n        return _ref6.apply(this, arguments);\n      }\n\n      return login;\n    }()\n  }, {\n    key: 'logout',\n    value: function () {\n      var _ref7 = (0, _asyncToGenerator3.default)(\n      /*#__PURE__*/\n      _regenerator2.default.mark(function _callee7(options) {\n        var _this = this;\n\n        var path;\n        return _regenerator2.default.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                path = null;\n                options = options || {};\n\n                if (typeof options === 'string') {\n                  path = options;\n                  options = {};\n                }\n\n                return _context7.abrupt('return', this._oktaAuth.signOut(options).then(function () {\n                  if (!options.postLogoutRedirectUri && !_this._config.postLogoutRedirectUri) {\n                    _this._history.push(path || '/');\n                  }\n                }));\n\n              case 4:\n              case 'end':\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n\n      function logout(_x3) {\n        return _ref7.apply(this, arguments);\n      }\n\n      return logout;\n    }()\n  }, {\n    key: 'redirect',\n    value: function () {\n      var _ref8 = (0, _asyncToGenerator3.default)(\n      /*#__PURE__*/\n      _regenerator2.default.mark(function _callee8() {\n        var additionalParams = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n        var params;\n        return _regenerator2.default.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                // normalize config object\n                params = (0, _configurationValidation.buildConfigObject)(additionalParams); // set defaults\n\n                params.responseType = params.responseType || this._config.responseType || ['id_token', 'token'];\n                params.scopes = params.scopes || this._config.scopes || ['openid', 'email', 'profile'];\n\n                this._oktaAuth.token.getWithRedirect(params); // return a promise that doesn't terminate so nothing\n                // happens after setting window.location\n\n                /* eslint-disable-next-line no-unused-vars */\n\n\n                return _context8.abrupt('return', new _promise2.default(function (resolve, reject) {}));\n\n              case 5:\n              case 'end':\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this);\n      }));\n\n      function redirect() {\n        return _ref8.apply(this, arguments);\n      }\n\n      return redirect;\n    }()\n  }]);\n  return Auth;\n}();\n\nexports.default = Auth;","map":{"version":3,"sources":["/home/nil/Projects/mission-control-fe/mission-control-client/node_modules/@okta/okta-react/dist/Auth.js"],"names":["Object","defineProperty","exports","value","_promise","require","_promise2","_interopRequireDefault","_stringify","_stringify2","_regenerator","_regenerator2","_getIterator2","_getIterator3","_asyncToGenerator2","_asyncToGenerator3","_classCallCheck2","_classCallCheck3","_createClass2","_createClass3","_configurationValidation","_oktaAuthJs","_oktaAuthJs2","_packageInfo","_packageInfo2","obj","__esModule","default","containsAuthTokens","Auth","config","testing","disableHttpsCheck","authConfig","buildConfigObject","assertIssuer","issuer","assertClientId","clientId","assertRedirectUri","redirectUri","_oktaAuth","userAgent","name","version","_config","_history","history","handleAuthentication","bind","isAuthenticated","getUser","getIdToken","getAccessToken","login","logout","redirect","key","_ref","mark","_callee","tokens","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_iterator","_step","token","wrap","_callee$","_context","prev","next","parseFromUrl","sent","Array","isArray","undefined","done","idToken","tokenManager","add","accessToken","t0","return","finish","stop","apply","arguments","_ref2","_callee2","_callee2$","_context2","location","hash","test","abrupt","_ref3","_callee3","userinfo","_callee3$","_context3","get","getUserInfo","sub","claims","_ref4","_callee4","_callee4$","_context4","_ref5","_callee5","_callee5$","_context5","_ref6","_callee6","fromUri","additionalParams","referrerPath","auth","_callee6$","_context6","pathname","localStorage","setItem","onAuthRequired","_x","_x2","_ref7","_callee7","options","_this","path","_callee7$","_context7","signOut","then","postLogoutRedirectUri","push","_x3","_ref8","_callee8","length","params","_callee8$","_context8","responseType","scopes","getWithRedirect","resolve","reject"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _promise = require('babel-runtime/core-js/promise');\n\nvar _promise2 = _interopRequireDefault(_promise);\n\nvar _stringify = require('babel-runtime/core-js/json/stringify');\n\nvar _stringify2 = _interopRequireDefault(_stringify);\n\nvar _regenerator = require('babel-runtime/regenerator');\n\nvar _regenerator2 = _interopRequireDefault(_regenerator);\n\nvar _getIterator2 = require('babel-runtime/core-js/get-iterator');\n\nvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\nvar _asyncToGenerator2 = require('babel-runtime/helpers/asyncToGenerator');\n\nvar _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _configurationValidation = require('@okta/configuration-validation');\n\nvar _oktaAuthJs = require('@okta/okta-auth-js');\n\nvar _oktaAuthJs2 = _interopRequireDefault(_oktaAuthJs);\n\nvar _packageInfo = require('./packageInfo');\n\nvar _packageInfo2 = _interopRequireDefault(_packageInfo);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar containsAuthTokens = /id_token|access_token|code/; /*\n                                                        * Copyright (c) 2017-Present, Okta, Inc. and/or its affiliates. All rights reserved.\n                                                        * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n                                                        *\n                                                        * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n                                                        * Unless required by applicable law or agreed to in writing, software\n                                                        * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n                                                        * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n                                                        *\n                                                        * See the License for the specific language governing permissions and limitations under the License.\n                                                        */\n\nvar Auth = function () {\n  function Auth(config) {\n    (0, _classCallCheck3.default)(this, Auth);\n\n    var testing = {\n      // If the config is undefined, cast it to false\n      disableHttpsCheck: !!config.disableHttpsCheck\n    };\n\n    // normalize authJS config. In this SDK, we allow underscore on certain properties, but AuthJS consistently uses camel case.\n    var authConfig = (0, _configurationValidation.buildConfigObject)(config);\n    (0, _configurationValidation.assertIssuer)(authConfig.issuer, testing);\n    (0, _configurationValidation.assertClientId)(authConfig.clientId);\n    (0, _configurationValidation.assertRedirectUri)(authConfig.redirectUri);\n    this._oktaAuth = new _oktaAuthJs2.default(authConfig);\n    this._oktaAuth.userAgent = _packageInfo2.default.name + '/' + _packageInfo2.default.version + ' ' + this._oktaAuth.userAgent;\n    this._config = authConfig; // use normalized config\n    this._history = config.history;\n\n    this.handleAuthentication = this.handleAuthentication.bind(this);\n    this.isAuthenticated = this.isAuthenticated.bind(this);\n    this.getUser = this.getUser.bind(this);\n    this.getIdToken = this.getIdToken.bind(this);\n    this.getAccessToken = this.getAccessToken.bind(this);\n    this.login = this.login.bind(this);\n    this.logout = this.logout.bind(this);\n    this.redirect = this.redirect.bind(this);\n  }\n\n  (0, _createClass3.default)(Auth, [{\n    key: 'handleAuthentication',\n    value: function () {\n      var _ref = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee() {\n        var tokens, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, token;\n\n        return _regenerator2.default.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this._oktaAuth.token.parseFromUrl();\n\n              case 2:\n                tokens = _context.sent;\n\n                tokens = Array.isArray(tokens) ? tokens : [tokens];\n                _iteratorNormalCompletion = true;\n                _didIteratorError = false;\n                _iteratorError = undefined;\n                _context.prev = 7;\n                for (_iterator = (0, _getIterator3.default)(tokens); !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                  token = _step.value;\n\n                  if (token.idToken) {\n                    this._oktaAuth.tokenManager.add('idToken', token);\n                  } else if (token.accessToken) {\n                    this._oktaAuth.tokenManager.add('accessToken', token);\n                  }\n                }\n                _context.next = 15;\n                break;\n\n              case 11:\n                _context.prev = 11;\n                _context.t0 = _context['catch'](7);\n                _didIteratorError = true;\n                _iteratorError = _context.t0;\n\n              case 15:\n                _context.prev = 15;\n                _context.prev = 16;\n\n                if (!_iteratorNormalCompletion && _iterator.return) {\n                  _iterator.return();\n                }\n\n              case 18:\n                _context.prev = 18;\n\n                if (!_didIteratorError) {\n                  _context.next = 21;\n                  break;\n                }\n\n                throw _iteratorError;\n\n              case 21:\n                return _context.finish(18);\n\n              case 22:\n                return _context.finish(15);\n\n              case 23:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[7, 11, 15, 23], [16,, 18, 22]]);\n      }));\n\n      function handleAuthentication() {\n        return _ref.apply(this, arguments);\n      }\n\n      return handleAuthentication;\n    }()\n  }, {\n    key: 'isAuthenticated',\n    value: function () {\n      var _ref2 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee2() {\n        return _regenerator2.default.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (!(location && location.hash && containsAuthTokens.test(location.hash))) {\n                  _context2.next = 2;\n                  break;\n                }\n\n                return _context2.abrupt('return', null);\n\n              case 2:\n                _context2.next = 4;\n                return this.getAccessToken();\n\n              case 4:\n                _context2.t0 = !!_context2.sent;\n\n                if (_context2.t0) {\n                  _context2.next = 9;\n                  break;\n                }\n\n                _context2.next = 8;\n                return this.getIdToken();\n\n              case 8:\n                _context2.t0 = !!_context2.sent;\n\n              case 9:\n                return _context2.abrupt('return', _context2.t0);\n\n              case 10:\n              case 'end':\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function isAuthenticated() {\n        return _ref2.apply(this, arguments);\n      }\n\n      return isAuthenticated;\n    }()\n  }, {\n    key: 'getUser',\n    value: function () {\n      var _ref3 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee3() {\n        var accessToken, idToken, userinfo;\n        return _regenerator2.default.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return this._oktaAuth.tokenManager.get('accessToken');\n\n              case 2:\n                accessToken = _context3.sent;\n                _context3.next = 5;\n                return this._oktaAuth.tokenManager.get('idToken');\n\n              case 5:\n                idToken = _context3.sent;\n\n                if (!(accessToken && idToken)) {\n                  _context3.next = 12;\n                  break;\n                }\n\n                _context3.next = 9;\n                return this._oktaAuth.token.getUserInfo(accessToken);\n\n              case 9:\n                userinfo = _context3.sent;\n\n                if (!(userinfo.sub === idToken.claims.sub)) {\n                  _context3.next = 12;\n                  break;\n                }\n\n                return _context3.abrupt('return', userinfo);\n\n              case 12:\n                return _context3.abrupt('return', idToken ? idToken.claims : undefined);\n\n              case 13:\n              case 'end':\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function getUser() {\n        return _ref3.apply(this, arguments);\n      }\n\n      return getUser;\n    }()\n  }, {\n    key: 'getIdToken',\n    value: function () {\n      var _ref4 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee4() {\n        var idToken;\n        return _regenerator2.default.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.prev = 0;\n                _context4.next = 3;\n                return this._oktaAuth.tokenManager.get('idToken');\n\n              case 3:\n                idToken = _context4.sent;\n                return _context4.abrupt('return', idToken.idToken);\n\n              case 7:\n                _context4.prev = 7;\n                _context4.t0 = _context4['catch'](0);\n                return _context4.abrupt('return', undefined);\n\n              case 10:\n              case 'end':\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this, [[0, 7]]);\n      }));\n\n      function getIdToken() {\n        return _ref4.apply(this, arguments);\n      }\n\n      return getIdToken;\n    }()\n  }, {\n    key: 'getAccessToken',\n    value: function () {\n      var _ref5 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee5() {\n        var accessToken;\n        return _regenerator2.default.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                _context5.prev = 0;\n                _context5.next = 3;\n                return this._oktaAuth.tokenManager.get('accessToken');\n\n              case 3:\n                accessToken = _context5.sent;\n                return _context5.abrupt('return', accessToken.accessToken);\n\n              case 7:\n                _context5.prev = 7;\n                _context5.t0 = _context5['catch'](0);\n                return _context5.abrupt('return', undefined);\n\n              case 10:\n              case 'end':\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this, [[0, 7]]);\n      }));\n\n      function getAccessToken() {\n        return _ref5.apply(this, arguments);\n      }\n\n      return getAccessToken;\n    }()\n  }, {\n    key: 'login',\n    value: function () {\n      var _ref6 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee6(fromUri, additionalParams) {\n        var referrerPath, auth, history;\n        return _regenerator2.default.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                referrerPath = fromUri ? { pathname: fromUri } : this._history.location;\n\n                localStorage.setItem('secureRouterReferrerPath', (0, _stringify2.default)(referrerPath));\n\n                if (!this._config.onAuthRequired) {\n                  _context6.next = 6;\n                  break;\n                }\n\n                auth = this;\n                history = this._history;\n                return _context6.abrupt('return', this._config.onAuthRequired({ auth: auth, history: history }));\n\n              case 6:\n                _context6.next = 8;\n                return this.redirect(additionalParams);\n\n              case 8:\n              case 'end':\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function login(_x, _x2) {\n        return _ref6.apply(this, arguments);\n      }\n\n      return login;\n    }()\n  }, {\n    key: 'logout',\n    value: function () {\n      var _ref7 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee7(options) {\n        var _this = this;\n\n        var path;\n        return _regenerator2.default.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                path = null;\n\n                options = options || {};\n                if (typeof options === 'string') {\n                  path = options;\n                  options = {};\n                }\n                return _context7.abrupt('return', this._oktaAuth.signOut(options).then(function () {\n                  if (!options.postLogoutRedirectUri && !_this._config.postLogoutRedirectUri) {\n                    _this._history.push(path || '/');\n                  }\n                }));\n\n              case 4:\n              case 'end':\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n\n      function logout(_x3) {\n        return _ref7.apply(this, arguments);\n      }\n\n      return logout;\n    }()\n  }, {\n    key: 'redirect',\n    value: function () {\n      var _ref8 = (0, _asyncToGenerator3.default)( /*#__PURE__*/_regenerator2.default.mark(function _callee8() {\n        var additionalParams = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n        var params;\n        return _regenerator2.default.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                // normalize config object\n                params = (0, _configurationValidation.buildConfigObject)(additionalParams);\n\n                // set defaults\n\n                params.responseType = params.responseType || this._config.responseType || ['id_token', 'token'];\n\n                params.scopes = params.scopes || this._config.scopes || ['openid', 'email', 'profile'];\n\n                this._oktaAuth.token.getWithRedirect(params);\n\n                // return a promise that doesn't terminate so nothing\n                // happens after setting window.location\n                /* eslint-disable-next-line no-unused-vars */\n                return _context8.abrupt('return', new _promise2.default(function (resolve, reject) {}));\n\n              case 5:\n              case 'end':\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this);\n      }));\n\n      function redirect() {\n        return _ref8.apply(this, arguments);\n      }\n\n      return redirect;\n    }()\n  }]);\n  return Auth;\n}();\n\nexports.default = Auth;"]},"metadata":{},"sourceType":"script"}